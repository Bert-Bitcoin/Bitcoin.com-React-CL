# Cursor AI Rules for Design System Integration
# Project: React + Tailwind + Tokens + Figma MCP + Storybook

## Project Metadata

- **Figma Design File**: https://www.figma.com/design/whUdbUxyPxMpIMbTapDqdn/Web-component-library--AI-?node-id=17998-17298&t=fCYrU0ejGmjVXf4L-1
- **Icons Path**: `src/icons`
- **Fonts Path**: `src/fonts`
- **Tokens Path**: `src/tokens`
- **Tailwind Config**: `tailwind.config.ts`
- **Component Path**: `src/components`
- **Storybook Static Dir**: `storybook-static`
- **Sync Scripts**: `scripts/sync-figma-tokens.ts`, `scripts/generate-icons.ts`
- **Theme Strategy**: `tailwind-dark-mode-class`

---

## ü§ñ AI Agent Consumption Rules

### Rule: ai-guide-adherence (REQUIRED)
For detailed implementation patterns, strictly follow [AI_CONSUMPTION_GUIDE.md](./AI_CONSUMPTION_GUIDE.md). This file contains the "Gold Standard" for code generation in this project.

### Rule: semantic-tokens-only (STRICT)
AI Agents must NEVER generate code with raw hex values or standard Tailwind colors (e.g., `bg-blue-500`). ALWAYS use the project's semantic tokens (e.g., `bg-primary-100`, `text-surface`).

### Rule: strict-typography-mapping (STRICT)
- **Headings**: Always `Elza` + `uppercase` (e.g., `text-heading-lg`).
- **Numbers**: Always `IBM Plex Sans` (e.g., `text-numeric`).
- **Body**: `Satoshi` (e.g., `text-body`).

---

## üîó Figma Design System Integration

### Rule: figma-mpc-sync (REQUIRED)
Sync Figma design tokens and components via `scripts/sync-figma-tokens.ts`. Ensure names and tokens map 1:1.

### Rule: figma-child-component-reuse (STRICT)
When creating new components from Figma via the Figma MCP server, always inspect the Figma component hierarchy for child components and verify whether those child parts already exist in the React Component Library (`src/components`). If matching components exist (e.g., buttons, icons, tabs, inputs, logos, mini-illustrations), reuse the existing React components instead of re-implementing them, and compose the new component from these building blocks.

### Rule: figma-component-variations (STRICT)
Before creating or modifying a component, **always check the Figma component library** for defined variations (e.g., sizes, states, variants). Respect and implement all variations exactly as specified in Figma. Component props and variants in code must match Figma's component structure. Use Figma MCP tools to inspect component variations and states.

### Rule: figma-component-grouping (STRICT)
Always follow the component grouping and organization as defined in the Figma design file (https://www.figma.com/design/whUdbUxyPxMpIMbTapDqdn/Web-component-library--AI-). When creating or organizing components in the codebase and Storybook, mirror the exact grouping structure from Figma. This ensures consistency between design and development. Component categories, subcategories, and naming conventions must match the Figma file structure.

Example Figma groupings to follow:
- **Design System** - Colors, tokens, theme variables
- **Foundation** - Icons, typography, illustrations, spacing
- **Components** - Grouped by function (Form Elements, UI Elements, etc.)

Reference: [Figma Web Component Library](https://www.figma.com/design/whUdbUxyPxMpIMbTapDqdn/Web-component-library--AI-?node-id=17998-17298&t=fCYrU0ejGmjVXf4L-1)

---

## üé® Tailwind & Tokens

### Rule: tailwind-token-usage (STRICT)
Use Tailwind utility classes **only** when backed by values from `src/tokens` or Tailwind config. Avoid arbitrary values unless mirrored from Figma tokens.

### Rule: prefer-token-class (STRICT)
Prefer using `className` with tokenized Tailwind utilities (e.g., `text-token-heading-lg`) over inline styles.

### Rule: no-hardcoded-css (STRICT)
Do not use hardcoded `style={{ ... }}` props for spacing, color, or typography unless absolutely required.

### Rule: color-palette-only (STRICT)
Only use colors that are defined in the design system color palette (found in `src/tokens` or `src/components/colorpalette`). No custom colors, hex values, or arbitrary color values are allowed outside of the approved color palette. All color usage must reference tokenized color values from the design system.

---

## üåó Theming

### Rule: no-dark-variants (STRICT)
**NEVER use `dark:` Tailwind utility classes** when generating new components or Storybook UI. Dark mode is handled automatically through CSS variables defined in the token system. The design tokens already contain both light and dark mode values that switch based on the theme class applied to the root element. Using `dark:` classes is redundant and not needed.

Example:
```tsx
// Correct - semantic tokens handle dark mode automatically
<div className="bg-surface text-on-surface">Content</div>

// Incorrect - do NOT use dark: variants
<div className="bg-white dark:bg-gray-900 text-black dark:text-white">Content</div>
```

### Rule: theme-support (STRICT)
Ensure all components support both light and dark themes using CSS variables from the token system. Dark mode is automatically handled by semantic tokens - no `dark:` utility classes needed.

### Rule: validate-tailwind-themes (RECOMMENDED)
Ensure both themes render correctly using `tailwind.config.ts` theme extensions and CSS vars from tokens.

### Rule: figma-dark-mode-colors (STRICT)
Each color defined in Figma has a corresponding dark mode variant. Always implement both light and dark color variants for each component, matching the Figma design system's color definitions. When syncing tokens or creating components, ensure every color token has its dark mode counterpart applied.

---

## üìÅ File/Folder Structure

### Rule: component-structure (REQUIRED)
Follow `src/components/ComponentName/Component.tsx` + co-located `stories.tsx`, `test.tsx`, and `index.ts` structure.

Example:
```
src/components/Button/
  - Button.tsx
  - Button.stories.tsx
  - Button.test.tsx
  - index.ts
```

### Rule: script-placement (RECOMMENDED)
Token and icon sync scripts should live in `scripts/` folder and be self-documented.

---

## üì¶ Icon & Font Asset Rules

### Rule: icon-usage (STRICT)
Use only icons from `src/icons`. Each must be imported from the `index.ts` barrel file.

### Rule: font-usage (STRICT)
Fonts must be loaded from `src/fonts` and referenced via Tailwind `extend.fontFamily` config.

### Rule: elza-font-capitalization (STRICT)
When using the Elza font family (Elza, Elza Narrow) on any HTML element or component, the text content **must always be capitalized**. The Elza font is used for display and heading text in the design system. All typography tokens that use Elza (display, heading-xl, heading-lg, heading-md, heading-sm) have `textTransform: 'uppercase'` built-in. If manually applying Elza font, always add the Tailwind `uppercase` class or `text-transform: uppercase` CSS property.

Example:
```tsx
// Correct - using typography token (uppercase is automatic)
<h1 className="text-display">Bitcoin Rewards</h1>

// Correct - manually applying Elza with uppercase
<h1 className="font-['Elza_Narrow'] uppercase">Bitcoin Rewards</h1>

// Incorrect - missing uppercase when manually using Elza
<h1 className="font-['Elza_Narrow']">Bitcoin Rewards</h1>
```

### Rule: ibm-plex-sans-numeric (STRICT)
**Always use IBM Plex Sans font for displaying numeric values** (numbers, prices, amounts, quantities, percentages, etc.). IBM Plex Sans is designed for optimal readability of numbers and should be applied to any content that contains numeric data. Use the `font-['IBMPlexSans']` class or ensure your typography token uses IBM Plex Sans when rendering numeric content.

Example:
```tsx
// Correct - using IBM Plex Sans for numeric values
<span className="font-['IBMPlexSans']">$1,234.56</span>
<div className="font-['IBMPlexSans']">42.5%</div>
<p className="font-['IBMPlexSans']">0.00012345 BTC</p>

// Incorrect - not using IBM Plex Sans for numbers
<span className="font-satoshi">$1,234.56</span>
<div>42.5%</div>
```

This applies to:
- Cryptocurrency amounts and prices
- Fiat currency values
- Percentages
- Quantities and counts
- Transaction amounts
- Wallet balances
- Any numeric data display

---

## üß© Component Development

### Rule: typescript-enforcement (STRICT)
All components must be written in TypeScript (`.tsx`) and fully typed. No `any` types unless absolutely necessary.

### Rule: accessibility-baseline (RECOMMENDED)
Use semantic HTML and ARIA roles where applicable. Buttons must be real `<button>` elements, not divs with click handlers.

---

## üìö Storybook Integration

### Rule: storybook-sync (REQUIRED)
Every component must have an up-to-date Storybook story (`*.stories.tsx`) covering default, variants, and both themes.

### Rule: storybook-controls (RECOMMENDED)
Expose all component props using `argTypes` and Storybook Controls for interactive documentation.

### Rule: storybook-dark-mode (REQUIRED)
Use Storybook theming addon or wrapper to preview light/dark styles consistently.

### Rule: storybook-component-reuse (STRICT)
When creating Storybook stories, **always reuse existing components from the component library** for any supporting UI elements in examples. Never create custom markup or one-off UI elements when an existing component can be used. This includes but is not limited to: Cards, Tables, Buttons, Inputs, Icons, Tabs, Modals, Typography, Layouts, etc. This ensures consistency across stories, reduces code duplication, and demonstrates real-world component composition patterns.

Example:
```tsx
// Correct - reusing existing Card and Button components
export const ExampleStory: Story = {
  render: (args) => (
    <Card variant="outlined">
      <YourComponent {...args} />
      <Button variant="primary">Action</Button>
    </Card>
  ),
};

// Incorrect - creating custom markup instead of using existing components
export const ExampleStory: Story = {
  render: (args) => (
    <div className="border rounded p-4">
      <YourComponent {...args} />
      <div className="bg-primary-500 px-4 py-2">Action</div>
    </div>
  ),
};
```

Before creating any supporting UI in a story, check `src/components/` to see if a suitable component already exists.

---

## üîÅ Change Sync Behavior

### Rule: token-sync-watch (REQUIRED)
When `src/tokens` changes or `scripts/sync-figma-tokens.ts` is run, affected components and stories must be re-evaluated for consistency.

### Rule: icon-regeneration (REQUIRED)
Run `scripts/generate-icons.ts` when icon assets in `src/icons` are changed to refresh the icon set.

---

## Implementation Guidelines

### When Creating New Components:
1. **Check Figma first** - Use Figma MCP tools to inspect the component's variations, properties, and states
2. **Verify component grouping** - Check the [Figma file](https://www.figma.com/design/whUdbUxyPxMpIMbTapDqdn/Web-component-library--AI-?node-id=17998-17298&t=fCYrU0ejGmjVXf4L-1) to see which category the component belongs to
3. Create folder in `src/components/ComponentName/`
4. Create `ComponentName.tsx` with full TypeScript types matching Figma variants
5. Create `ComponentName.stories.tsx` with the correct Storybook path matching Figma grouping
6. Export from `index.ts`
7. Use only token-based Tailwind classes
8. Support both light and dark themes
9. Test accessibility with semantic HTML

### When Inspecting Figma Components:
1. Open the [Figma design file](https://www.figma.com/design/whUdbUxyPxMpIMbTapDqdn/Web-component-library--AI-?node-id=17998-17298&t=fCYrU0ejGmjVXf4L-1) to identify component location and grouping
2. Use `mcp_Figma_Desktop_get_design_context` to view component structure and variations
3. Use `mcp_Figma_Desktop_get_variable_defs` to see design tokens applied to variants
4. Use `mcp_Figma_Desktop_get_screenshot` to visually reference the component
5. Document all variants found (e.g., size: sm/md/lg, state: default/hover/disabled)
6. Note the component's category/grouping in Figma for proper Storybook organization
7. Ensure TypeScript props/types align with Figma component properties

### When Modifying Styles:
1. Check if tokens exist in `src/tokens` first
2. Use Tailwind utilities backed by tokens
3. Avoid arbitrary values like `text-[#123456]`
4. **Only use colors from the approved color palette** - no custom hex values or arbitrary colors
5. **NEVER use `dark:` variants** - dark mode is handled automatically by semantic tokens
6. **For display/heading text** - use typography tokens (text-display, text-heading-xl, etc.) which have Elza font and uppercase built-in
7. **When manually using Elza font** - always add `uppercase` class for capitalization
8. Test in both light and dark modes

### When Syncing Design Tokens:
1. Run `scripts/sync-figma-tokens.ts`
2. Review changes in `src/tokens/generated.ts`
3. Update affected components if token names changed
4. Rebuild Storybook to verify visual consistency

### When Adding Icons:
1. Add SVG to `src/icons`
2. Run `scripts/generate-icons.ts`
3. Import from `src/components/icons/index.ts`
4. Use consistent naming conventions

### When Creating Storybook Stories:
1. Review existing components in `src/components/` before creating any supporting UI
2. **Always reuse existing components** for wrapper elements, containers, and interactive elements
3. Use existing components to demonstrate real-world composition patterns
4. Common components to reuse in stories:
   - `Card` - for wrapping examples or showing component context
   - `Button` - for interactive actions in examples
   - `Table` - for displaying tabular data in examples
   - `Tabs` - for organizing multiple example variants
   - `Modal` or `Window` - for overlay/dialog examples
   - `Typography` components - for text content in examples
   - `Icon` - for visual elements
   - Layout components (`WebLayout`, `WebAppLayout`) - for full-page examples
5. Import and compose existing components rather than creating custom markup
6. Document component composition patterns that users can learn from
7. Ensure all supporting components use the same theming and token system
